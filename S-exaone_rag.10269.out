Loading checkpoint shards:   0%|          | 0/27 [00:00<?, ?it/s]Loading checkpoint shards:   4%|â–         | 1/27 [00:01<00:26,  1.01s/it]Loading checkpoint shards:   7%|â–‹         | 2/27 [00:02<00:27,  1.09s/it]Loading checkpoint shards:  11%|â–ˆ         | 3/27 [00:03<00:25,  1.08s/it]Loading checkpoint shards:  15%|â–ˆâ–        | 4/27 [00:04<00:24,  1.07s/it]Loading checkpoint shards:  19%|â–ˆâ–Š        | 5/27 [00:05<00:23,  1.07s/it]Loading checkpoint shards:  22%|â–ˆâ–ˆâ–       | 6/27 [00:06<00:22,  1.07s/it]Loading checkpoint shards:  26%|â–ˆâ–ˆâ–Œ       | 7/27 [00:07<00:21,  1.08s/it]Loading checkpoint shards:  30%|â–ˆâ–ˆâ–‰       | 8/27 [00:08<00:20,  1.08s/it]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–      | 9/27 [00:09<00:18,  1.03s/it]Loading checkpoint shards:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 10/27 [00:10<00:15,  1.10it/s]Loading checkpoint shards:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 11/27 [00:10<00:13,  1.20it/s]Loading checkpoint shards:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/27 [00:11<00:11,  1.27it/s]Loading checkpoint shards:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 13/27 [00:12<00:10,  1.33it/s]Loading checkpoint shards:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 14/27 [00:12<00:09,  1.38it/s]Loading checkpoint shards:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 15/27 [00:13<00:08,  1.42it/s]Loading checkpoint shards:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 16/27 [00:14<00:07,  1.45it/s]Loading checkpoint shards:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 17/27 [00:14<00:06,  1.49it/s]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 18/27 [00:15<00:05,  1.51it/s]Loading checkpoint shards:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 19/27 [00:16<00:05,  1.53it/s]Loading checkpoint shards:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 20/27 [00:16<00:04,  1.54it/s]Loading checkpoint shards:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 21/27 [00:17<00:03,  1.55it/s]Loading checkpoint shards:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 22/27 [00:17<00:03,  1.57it/s]Loading checkpoint shards:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 23/27 [00:18<00:02,  1.61it/s]Loading checkpoint shards:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 24/27 [00:19<00:01,  1.61it/s]Loading checkpoint shards:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 25/27 [00:19<00:01,  1.61it/s]Loading checkpoint shards:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 26/27 [00:20<00:00,  1.61it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 27/27 [00:20<00:00,  1.76it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 27/27 [00:20<00:00,  1.30it/s]
Some parameters are on the meta device because they were offloaded to the cpu.
/home/hyun/ragfire/code/langgraph/retrieve_top1.py:7: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  embeddings = HuggingFaceEmbeddings(model_name="BAAI/bge-m3")
/home/hyun/ragfire/code/langgraph/retrieve_top1.py:8: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  vectorstore = Chroma(
<IPython.core.display.Image object>

>>> Top-1ê³¼ ë™ì¼í•œ chapter('ì œ7ì¥ ë²Œì¹™')ì™€ article('ì œ39ì¡°(ê³¼íƒœë£Œ)')ì„ ê°€ì§„ ëª¨ë“  ë¬¸ì„œ <<<

==================================================
ğŸ”„ Node: [1;36mretrieve[0m ğŸ”„
- - - - - - - - - - - - - - - - - - - - - - - - - 
[1;32mquestion[0m:
ê³¼íƒœë£Œì˜ ë¶€ê³¼
[1;32mcontext[0m:
 7ì˜4. ì œ19ì¡°ì˜2ì œ3í•­ì— ë”°ë¥¸ ì‹œì •ëª…ë ¹ì„ ë”°ë¥´ì§€ ì•„ë‹ˆí•œ ì
8. ì œ20ì¡°ì œ1í•­ì œ2í˜¸ì˜ ê·œì •ì— ë”°ë¥¸ ìœ„í—˜ë¬¼ì˜ ìš´ë°˜ì— ê´€í•œ ì„¸ë¶€ê¸°ì¤€ì„ ìœ„ë°˜í•œ ì
9. ì œ21ì¡°ì œ3í•­ì˜ ê·œì •ì„ ìœ„ë°˜í•˜ì—¬ ìœ„í—˜ë¬¼ì˜ ìš´ì†¡ì— ê´€í•œ ê¸°ì¤€ì„ ë”°ë¥´ì§€ ì•„ë‹ˆí•œ ì
â‘¡ ì œ1í•­ì˜ ê·œì •ì— ë”°ë¥¸ ê³¼íƒœë£ŒëŠ” ëŒ€í†µë ¹ë ¹ì´ ì •í•˜ëŠ” ë°”ì— ë”°ë¼ ì‹œã†ë„ì§€ì‚¬, ì†Œë°©ë³¸ë¶€ì¥ ë˜ëŠ” ì†Œë°©ì„œì¥(ì´í•˜ â€œë¶€ê³¼ê¶Œìâ€ë¼ í•œë‹¤)ì´ ë¶€ê³¼ã†ì§•ìˆ˜í•œë‹¤.
â‘¢ ì‚­ì œ <2014. 12. 30.>
â‘£ ì‚­ì œ <2014. 12. 30.>
â‘¤ ì‚­ì œ <2014. 12. 30.>
â‘¥ì œ4ì¡° ë° ì œ5ì¡°ì œ2í•­ ê° í˜¸ ì™¸ì˜ ë¶€ë¶„ í›„ë‹¨ì˜ ê·œì •ì— ë”°ë¥¸ ì¡°ë¡€ì—ëŠ” 200ë§Œì› ì´í•˜ì˜ ê³¼íƒœë£Œë¥¼ ì •í•  ìˆ˜ ìˆë‹¤. ì´ ê²½ìš° ê³¼íƒœë£ŒëŠ” ë¶€ê³¼ê¶Œìê°€ ë¶€ê³¼ã†ì§•ìˆ˜í•œë‹¤. <ê°œì • 2016. 1. 27.>
â‘¦ ì‚­ì œ <2014. 12. 30.> [ìœ„í—˜ë¬¼ì•ˆì „ê´€ë¦¬ë²• / ì œ7ì¥ ë²Œì¹™ / ì œ39ì¡°(ê³¼íƒœë£Œ)]
ì œ39ì¡°(ê³¼íƒœë£Œ) â‘  ë‹¤ìŒ ê° í˜¸ì˜ ì–´ëŠ í•˜ë‚˜ì— í•´ë‹¹í•˜ëŠ” ìì—ê²ŒëŠ” 500ë§Œì› ì´í•˜ì˜ ê³¼íƒœë£Œë¥¼ ë¶€ê³¼í•œë‹¤. <ê°œì • 2014. 12. 30., 2016. 1. 27., 2020. 10. 20., 2023. 1. 3., 2024. 1. 30.>
1. ì œ5ì¡°ì œ2í•­ì œ1í˜¸ì˜ ê·œì •ì— ë”°ë¥¸ ìŠ¹ì¸ì„ ë°›ì§€ ì•„ë‹ˆí•œ ì
2. ì œ5ì¡°ì œ3í•­ì œ2í˜¸ì˜ ê·œì •ì— ë”°ë¥¸ ìœ„í—˜ë¬¼ì˜ ì €ì¥ ë˜ëŠ” ì·¨ê¸‰ì— ê´€í•œ ì„¸ë¶€ê¸°ì¤€ì„ ìœ„ë°˜í•œ ì
3. ì œ6ì¡°ì œ2í•­ì˜ ê·œì •ì— ë”°ë¥¸ í’ˆëª… ë“±ì˜ ë³€ê²½ì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ í—ˆìœ„ë¡œ í•œ ì
4. ì œ10ì¡°ì œ3í•­ì˜ ê·œì •ì— ë”°ë¥¸ ì§€ìœ„ìŠ¹ê³„ì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ í—ˆìœ„ë¡œ í•œ ì
5. ì œ11ì¡°ì˜ ê·œì •ì— ë”°ë¥¸ ì œì¡°ì†Œë“±ì˜ íì§€ì‹ ê³  ë˜ëŠ” ì œ15ì¡°ì œ3í•­ì˜ ê·œì •ì— ë”°ë¥¸ ì•ˆì „ê´€ë¦¬ìì˜ ì„ ì„ì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ í—ˆìœ„ë¡œ í•œ ì
5ì˜2. ì œ11ì¡°ì˜2ì œ2í•­ì„ ìœ„ë°˜í•˜ì—¬ ì‚¬ìš© ì¤‘ì§€ì‹ ê³  ë˜ëŠ” ì¬ê°œì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ ê±°ì§“ìœ¼ë¡œ í•œ ì
6. ì œ16ì¡°ì œ3í•­ì˜ ê·œì •ì„ ìœ„ë°˜í•˜ì—¬ ë“±ë¡ì‚¬í•­ì˜ ë³€ê²½ì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ í—ˆìœ„ë¡œ í•œ ì
6ì˜2. ì œ17ì¡°ì œ3í•­ì„ ìœ„ë°˜í•˜ì—¬ ì˜ˆë°©ê·œì •ì„ ì¤€ìˆ˜í•˜ì§€ ì•„ë‹ˆí•œ ì
7. ì œ18ì¡°ì œ1í•­ì˜ ê·œì •ì„ ìœ„ë°˜í•˜ì—¬ ì ê²€ê²°ê³¼ë¥¼ ê¸°ë¡ã†ë³´ì¡´í•˜ì§€ ì•„ë‹ˆí•œ ì
7ì˜2. ì œ18ì¡°ì œ2í•­ì„ ìœ„ë°˜í•˜ì—¬ ê¸°ê°„ ì´ë‚´ì— ì ê²€ê²°ê³¼ë¥¼ ì œì¶œí•˜ì§€ ì•„ë‹ˆí•œ ì
7ì˜3. ì œ19ì¡°ì˜2ì œ1í•­ì„ ìœ„ë°˜í•˜ì—¬ í¡ì—°ì„ í•œ ì
7ì˜4. ì œ19ì¡°ì˜2ì œ3í•­ì— ë”°ë¥¸ ì‹œì •ëª…ë ¹ì„ ë”°ë¥´ì§€ ì•„ë‹ˆí•œ ì
8. ì œ20ì¡°ì œ1í•­ì œ2í˜¸ì˜ ê·œì •ì— ë”°ë¥¸ ìœ„í—˜ë¬¼ì˜ ìš´ë°˜ì— ê´€í•œ ì„¸ë¶€ê¸°ì¤€ì„ ìœ„ë°˜í•œ ì
==================================================
# ê²€ìƒ‰ëœ ë¬¸ì„œë¥¼ ìƒíƒœì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤.
context=  7ì˜4. ì œ19ì¡°ì˜2ì œ3í•­ì— ë”°ë¥¸ ì‹œì •ëª…ë ¹ì„ ë”°ë¥´ì§€ ì•„ë‹ˆí•œ ì
8. ì œ20ì¡°ì œ1í•­ì œ2í˜¸ì˜ ê·œì •ì— ë”°ë¥¸ ìœ„í—˜ë¬¼ì˜ ìš´ë°˜ì— ê´€í•œ ì„¸ë¶€ê¸°ì¤€ì„ ìœ„ë°˜í•œ ì
9. ì œ21ì¡°ì œ3í•­ì˜ ê·œì •ì„ ìœ„ë°˜í•˜ì—¬ ìœ„í—˜ë¬¼ì˜ ìš´ì†¡ì— ê´€í•œ ê¸°ì¤€ì„ ë”°ë¥´ì§€ ì•„ë‹ˆí•œ ì
â‘¡ ì œ1í•­ì˜ ê·œì •ì— ë”°ë¥¸ ê³¼íƒœë£ŒëŠ” ëŒ€í†µë ¹ë ¹ì´ ì •í•˜ëŠ” ë°”ì— ë”°ë¼ ì‹œã†ë„ì§€ì‚¬, ì†Œë°©ë³¸ë¶€ì¥ ë˜ëŠ” ì†Œë°©ì„œì¥(ì´í•˜ â€œë¶€ê³¼ê¶Œìâ€ë¼ í•œë‹¤)ì´ ë¶€ê³¼ã†ì§•ìˆ˜í•œë‹¤.
â‘¢ ì‚­ì œ <2014. 12. 30.>
â‘£ ì‚­ì œ <2014. 12. 30.>
â‘¤ ì‚­ì œ <2014. 12. 30.>
â‘¥ì œ4ì¡° ë° ì œ5ì¡°ì œ2í•­ ê° í˜¸ ì™¸ì˜ ë¶€ë¶„ í›„ë‹¨ì˜ ê·œì •ì— ë”°ë¥¸ ì¡°ë¡€ì—ëŠ” 200ë§Œì› ì´í•˜ì˜ ê³¼íƒœë£Œë¥¼ ì •í•  ìˆ˜ ìˆë‹¤. ì´ ê²½ìš° ê³¼íƒœë£ŒëŠ” ë¶€ê³¼ê¶Œìê°€ ë¶€ê³¼ã†ì§•ìˆ˜í•œë‹¤. <ê°œì • 2016. 1. 27.>
â‘¦ ì‚­ì œ <2014. 12. 30.> [ìœ„í—˜ë¬¼ì•ˆì „ê´€ë¦¬ë²• / ì œ7ì¥ ë²Œì¹™ / ì œ39ì¡°(ê³¼íƒœë£Œ)]
ì œ39ì¡°(ê³¼íƒœë£Œ) â‘  ë‹¤ìŒ ê° í˜¸ì˜ ì–´ëŠ í•˜ë‚˜ì— í•´ë‹¹í•˜ëŠ” ìì—ê²ŒëŠ” 500ë§Œì› ì´í•˜ì˜ ê³¼íƒœë£Œë¥¼ ë¶€ê³¼í•œë‹¤. <ê°œì • 2014. 12. 30., 2016. 1. 27., 2020. 10. 20., 2023. 1. 3., 2024. 1. 30.>
1. ì œ5ì¡°ì œ2í•­ì œ1í˜¸ì˜ ê·œì •ì— ë”°ë¥¸ ìŠ¹ì¸ì„ ë°›ì§€ ì•„ë‹ˆí•œ ì
2. ì œ5ì¡°ì œ3í•­ì œ2í˜¸ì˜ ê·œì •ì— ë”°ë¥¸ ìœ„í—˜ë¬¼ì˜ ì €ì¥ ë˜ëŠ” ì·¨ê¸‰ì— ê´€í•œ ì„¸ë¶€ê¸°ì¤€ì„ ìœ„ë°˜í•œ ì
3. ì œ6ì¡°ì œ2í•­ì˜ ê·œì •ì— ë”°ë¥¸ í’ˆëª… ë“±ì˜ ë³€ê²½ì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ í—ˆìœ„ë¡œ í•œ ì
4. ì œ10ì¡°ì œ3í•­ì˜ ê·œì •ì— ë”°ë¥¸ ì§€ìœ„ìŠ¹ê³„ì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ í—ˆìœ„ë¡œ í•œ ì
5. ì œ11ì¡°ì˜ ê·œì •ì— ë”°ë¥¸ ì œì¡°ì†Œë“±ì˜ íì§€ì‹ ê³  ë˜ëŠ” ì œ15ì¡°ì œ3í•­ì˜ ê·œì •ì— ë”°ë¥¸ ì•ˆì „ê´€ë¦¬ìì˜ ì„ ì„ì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ í—ˆìœ„ë¡œ í•œ ì
5ì˜2. ì œ11ì¡°ì˜2ì œ2í•­ì„ ìœ„ë°˜í•˜ì—¬ ì‚¬ìš© ì¤‘ì§€ì‹ ê³  ë˜ëŠ” ì¬ê°œì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ ê±°ì§“ìœ¼ë¡œ í•œ ì
6. ì œ16ì¡°ì œ3í•­ì˜ ê·œì •ì„ ìœ„ë°˜í•˜ì—¬ ë“±ë¡ì‚¬í•­ì˜ ë³€ê²½ì‹ ê³ ë¥¼ ê¸°ê°„ ì´ë‚´ì— í•˜ì§€ ì•„ë‹ˆí•˜ê±°ë‚˜ í—ˆìœ„ë¡œ í•œ ì
6ì˜2. ì œ17ì¡°ì œ3í•­ì„ ìœ„ë°˜í•˜ì—¬ ì˜ˆë°©ê·œì •ì„ ì¤€ìˆ˜í•˜ì§€ ì•„ë‹ˆí•œ ì
7. ì œ18ì¡°ì œ1í•­ì˜ ê·œì •ì„ ìœ„ë°˜í•˜ì—¬ ì ê²€ê²°ê³¼ë¥¼ ê¸°ë¡ã†ë³´ì¡´í•˜ì§€ ì•„ë‹ˆí•œ ì
7ì˜2. ì œ18ì¡°ì œ2í•­ì„ ìœ„ë°˜í•˜ì—¬ ê¸°ê°„ ì´ë‚´ì— ì ê²€ê²°ê³¼ë¥¼ ì œì¶œí•˜ì§€ ì•„ë‹ˆí•œ ì
7ì˜3. ì œ19ì¡°ì˜2ì œ1í•­ì„ ìœ„ë°˜í•˜ì—¬ í¡ì—°ì„ í•œ ì
7ì˜4. ì œ19ì¡°ì˜2ì œ3í•­ì— ë”°ë¥¸ ì‹œì •ëª…ë ¹ì„ ë”°ë¥´ì§€ ì•„ë‹ˆí•œ ì
8. ì œ20ì¡°ì œ1í•­ì œ2í˜¸ì˜ ê·œì •ì— ë”°ë¥¸ ìœ„í—˜ë¬¼ì˜ ìš´ë°˜ì— ê´€í•œ ì„¸ë¶€ê¸°ì¤€ì„ ìœ„ë°˜í•œ ì
Traceback (most recent call last):
  File "/home/hyun/ragfire/code/langgraph/run_rag_exaone.py", line 122, in <module>
    invoke_graph(app, inputs, config)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/langchain_teddynote/messages.py", line 409, in invoke_graph
    for namespace, chunk in graph.stream(
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/langgraph/pregel/__init__.py", line 2323, in stream
    for _ in runner.tick(
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/langgraph/pregel/runner.py", line 232, in tick
    _panic_or_proceed(
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/langgraph/pregel/runner.py", line 458, in _panic_or_proceed
    raise exc
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/langgraph/pregel/executor.py", line 83, in done
    task.result()
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/langgraph/pregel/retry.py", line 40, in run_with_retry
    return task.proc.invoke(task.input, config)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/langgraph/utils/runnable.py", line 600, in invoke
    input = step.invoke(input, config, **kwargs)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/langgraph/utils/runnable.py", line 365, in invoke
    ret = context.run(self.func, *args, **kwargs)
  File "/home/hyun/ragfire/code/langgraph/run_rag_exaone.py", line 78, in llm_answer
    outputs = model.generate(**inputs, max_new_tokens=500)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/transformers/generation/utils.py", line 2223, in generate
    result = self._sample(
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/transformers/generation/utils.py", line 3211, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/accelerate/hooks.py", line 176, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/hyun/.cache/huggingface/modules/transformers_modules/exaone/modeling_exaone.py", line 1079, in forward
    lm_logits = self.lm_head(hidden_states)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/accelerate/hooks.py", line 176, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/hyun/anaconda3/envs/rag/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 152.00 MiB. GPU 0 has a total capacity of 23.69 GiB of which 151.69 MiB is free. Including non-PyTorch memory, this process has 23.54 GiB memory in use. Of the allocated memory 23.20 GiB is allocated by PyTorch, and 25.78 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
srun: error: laal1: task 0: Exited with exit code 1
